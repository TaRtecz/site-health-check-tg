# Развертывание проекта на сервере

Этот гайд поможет развернуть проект на вашем сервере с использованием Docker и Docker Compose.

## 1. Подготовка сервера

Убедитесь, что на вашем сервере установлены:
- `git`
- `docker`
- `docker-compose`

Если чего-то нет, установите, следуя официальным инструкциям для вашего дистрибутива Linux.

## 2. Клонирование репозитория

Подключитесь к серверу по SSH и выполните команду:
```bash
git clone <URL_вашего_репозитория>
cd <название_папки_проекта>
```

## 3. Настройка переменных окружения

Создайте файл `.env` из примера.
```bash
cp .env.example .env
```
Откройте файл `.env` в любом текстовом редакторе (например, `nano`):
```bash
nano .env
```
И **обязательно** заполните значения для:
- `TELEGRAM_BOT_TOKEN`
- `TELEGRAM_CHAT_ID`

Остальные переменные (для PostgreSQL) можно оставить по умолчанию, так как они будут использоваться внутри Docker-сети.

## 4. Сборка и запуск контейнеров

Выполните команду в корне проекта (где находится `docker-compose.yml`):
```bash
docker-compose up --build -d
```
- `--build` — пересобирает образ вашего приложения, если были изменения в коде.
- `-d` — запускает контейнеры в фоновом (detached) режиме.

Ваше приложение, база данных и все крон-задачи, отмеченные как `enabled`, теперь запущены. Политика `restart: always` в `docker-compose.yml` обеспечит их автоматический перезапуск после сбоя или перезагрузки сервера.

## 5. Полезные команды

- **Посмотреть логи приложения:**
  ```bash
  docker-compose logs -f app
  ```
  (`-f` для отслеживания в реальном времени)

- **Остановить приложение:**
  ```bash
  docker-compose down
  ```

- **Обновить приложение после изменений в коде:**
  ```bash
  # 1. Загружаем изменения из git
  git pull
  # 2. Пересобираем и перезапускаем контейнеры
  docker-compose up --build -d
  ```

- **Запустить CLI для управления сайтами:**
  ```bash
  docker-compose exec app node cli.js
  ```
  Эта команда выполнит `cli.js` внутри запущенного контейнера `app`. 